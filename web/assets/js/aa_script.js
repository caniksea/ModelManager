function showDiv(a){$("#homeDiv, #securityDiv, #editSecurityDiv, #addUserDiv, #editUserDiv, #modelDiv, #editModelDiv, #security2ModelDiv").hide(),$("#"+a).show(100)}function populateTableBody(a,b){var c=document.getElementById(b);if(c.innerHTML="","security2ModelTBody"===b){var d=a;a=a.model_securities}null!==a&&0!==a.length?"securityTBody"===b?populateSecurityTBody(a,c):"userTBody"===b?populateUserTBody(a,c):"modelTBody"===b?populateModelTBody(a,c):"security2ModelTBody"===b&&populateSecurityInModelTable(d,c):populateDefault(c)}function populateDefault(a){var b="0";"securityTBody"===a.id||"userTBody"===a.id||"modelTBody"===a.id?b="4":"security2ModelTBody"===a.id&&(b="3");var c=document.createElement("tr"),d=document.createElement("td");d.setAttribute("colspan",b),d.style.textAlign="center",d.innerHTML="NO DATA",c.appendChild(d),a.appendChild(c)}function populateSecurityTBody(a,b){for(var c=0;c<a.length;c++){var d=document.createElement("tr"),e="undefined"==typeof a[c].id?"":a[c].id,f=document.createElement("td");f.innerHTML=e,d.appendChild(f);var g=document.createElement("td");g.innerHTML="undefined"==typeof a[c].name?"":a[c].name,d.appendChild(g);var h=document.createElement("td");h.innerHTML="undefined"==typeof a[c].unit_price?"":a[c].unit_price,d.appendChild(h);var i=document.createElement("label");i.innerHTML="Edit",i.style.cursor="pointer",i.className="editLabel",i.setAttribute("onclick","editSecurity("+e+");");var j=document.createElement("label");j.innerHTML="Delete",j.className="deleteLabel",j.style.cursor="pointer",j.style.marginLeft="15px",j.setAttribute("onclick","deleteSecurity("+e+");");var k=document.createElement("td");k.appendChild(i),k.appendChild(j),d.appendChild(k),b.appendChild(d)}}function populateUserTBody(a,b){for(var c=0;c<a.length;c++){var d="undefined"==typeof a[c].user_id?"":a[c].user_id,e=document.createElement("tr"),f="undefined"==typeof a[c].username?"":a[c].username,g=document.createElement("td");g.innerHTML=f,e.appendChild(g);var h="undefined"==typeof a[c].name?"":a[c].name,i=document.createElement("td");i.innerHTML=h,e.appendChild(i);var j="undefined"==typeof a[c].status_id?"":a[c].status_id,k=1===j?"Active":"Inactive",l=document.createElement("td");l.innerHTML=k,e.appendChild(l);var m=document.createElement("label");m.innerHTML="Edit",m.style.cursor="pointer",m.className="editLabel",m.setAttribute("onclick","editUser("+d+");");var n=document.createElement("td");n.appendChild(m),e.appendChild(n),b.appendChild(e)}}function populateModelTBody(a,b){for(var c=0;c<a.length;c++){var d=document.createElement("tr"),e="undefined"==typeof a[c].model_id?"":a[c].model_id,f=document.createElement("td");f.innerHTML=e,d.appendChild(f);var g=document.createElement("td");g.innerHTML="undefined"==typeof a[c].name?"":a[c].name,d.appendChild(g);var h=document.createElement("td");h.innerHTML="undefined"==typeof a[c].description?"":a[c].description,d.appendChild(h);var i=document.createElement("label");i.innerHTML="Edit Model",i.style.cursor="pointer",i.className="editLabel",i.setAttribute("onclick","editModel("+e+");");var j=document.createElement("label");j.innerHTML="Delete Model",j.className="deleteLabel",j.style.cursor="pointer",j.style.marginLeft="15px",j.setAttribute("onclick","deleteModel("+e+");");var k=document.createElement("label");k.innerHTML="Add/Remove Security",k.style.cursor="pointer",k.className="editLabel",k.style.marginLeft="15px",k.setAttribute("onclick","modifySecurity("+e+");");var l=document.createElement("td");l.appendChild(i),l.appendChild(j),l.appendChild(k),d.appendChild(l),b.appendChild(d)}}function populateSecurityInModelTable(a,b){for(var c=0;c<a.model_securities.length;c++){var d=document.createElement("tr"),e=a.model_id,f=a.model_securities[c].security.id;$("#s2m_security option[value='"+f+"']").remove();var g=a.model_securities[c].security.name+"  [Unit Price: "+a.model_securities[c].security.unit_price+"]",h=document.createElement("td");h.innerHTML=g,d.appendChild(h);var i=document.createElement("td");i.innerHTML="undefined"==typeof a.model_securities[c].percentage?"":a.model_securities[c].percentage,d.appendChild(i);var j=document.createElement("label");j.innerHTML="Remove",j.style.cursor="pointer",j.className="deleteLabel",j.setAttribute("onclick","removeSecurityFromModel("+f+", "+e+");");var k=document.createElement("td");k.appendChild(j),d.appendChild(k),b.appendChild(d)}}function addToTableBody(a,b){var c=document.getElementById(b);if(c.firstElementChild.firstElementChild.colSpan>1&&(c.innerHTML=""),"securityTBody"===b){var d=document.createElement("tr"),e="undefined"==typeof a.id?"":a.id,f=document.createElement("td");f.innerHTML=e,d.appendChild(f);var g=document.createElement("td");g.innerHTML="undefined"==typeof a.name?"":a.name,d.appendChild(g);var h=document.createElement("td");h.innerHTML="undefined"==typeof a.unit_price?"":a.unit_price,d.appendChild(h);var i=document.createElement("label");i.innerHTML="Edit",i.style.cursor="pointer",i.className="editLabel",i.setAttribute("onclick","editSecurity("+e+");");var j=document.createElement("label");j.innerHTML="Delete",j.className="deleteLabel",j.style.cursor="pointer",j.style.marginLeft="15px",j.setAttribute("onclick","deleteSecurity("+e+");");var k=document.createElement("td");k.appendChild(i),k.appendChild(j),d.appendChild(k),c.appendChild(d)}else if("userTBody"===b){var l="undefined"==typeof a.user_id?"":a.user_id,d=document.createElement("tr"),m="undefined"==typeof a.username?"":a.username,n=document.createElement("td");n.innerHTML=m,d.appendChild(n);var o="undefined"==typeof a.name?"":a.name,g=document.createElement("td");g.innerHTML=o,d.appendChild(g);var p="undefined"==typeof a.status_id?"":a.status_id,q=1===p?"Active":"Inactive",r=document.createElement("td");r.innerHTML=q,d.appendChild(r);var i=document.createElement("label");i.innerHTML="Edit",i.style.cursor="pointer",i.className="editLabel",i.setAttribute("onclick","editUser("+l+");");var k=document.createElement("td");k.appendChild(i),d.appendChild(k),c.appendChild(d)}else if("modelTBody"===b){var d=document.createElement("tr"),s="undefined"==typeof a.model_id?"":a.model_id,f=document.createElement("td");f.innerHTML=s,d.appendChild(f);var g=document.createElement("td");g.innerHTML="undefined"==typeof a.name?"":a.name,d.appendChild(g);var t=document.createElement("td");t.innerHTML="undefined"==typeof a.description?"":a.description,d.appendChild(t);var i=document.createElement("label");i.innerHTML="Edit Model",i.style.cursor="pointer",i.className="editLabel",i.setAttribute("onclick","editModel("+s+");");var j=document.createElement("label");j.innerHTML="Delete Model",j.className="deleteLabel",j.style.cursor="pointer",j.style.marginLeft="15px",j.setAttribute("onclick","deleteModel("+s+");");var u=document.createElement("label");u.innerHTML="Add/Remove Security",u.style.cursor="pointer",u.className="editLabel",u.style.marginLeft="15px",u.setAttribute("onclick","modifySecurity("+s+");");var k=document.createElement("td");k.appendChild(i),k.appendChild(j),k.appendChild(u),d.appendChild(k),c.appendChild(d)}else if("security2ModelTBody"===b){var d=document.createElement("tr"),v=a.model_id,w=a.model_securities[0].security.id;$("#s2m_security option[value='"+w+"']").remove();var x=a.model_securities[0].security.name+"  [Unit Price: "+a.model_securities[0].security.unit_price+"]",y=document.createElement("td");y.innerHTML=x,d.appendChild(y);var z=document.createElement("td");z.innerHTML="undefined"==typeof a.model_securities[0].percentage?"":a.model_securities[0].percentage,d.appendChild(z);var A=document.createElement("label");A.innerHTML="Remove",A.style.cursor="pointer",A.className="deleteLabel",A.setAttribute("onclick","removeSecurityFromModel("+w+", "+v+");");var k=document.createElement("td");k.appendChild(A),d.appendChild(k),c.appendChild(d)}}function editSecurity(a){showDiv("editSecurityDiv"),$.ajax({url:endpoint+"get_security/"+a,type:"GET",dataType:"json",contentType:"application/json",success:function(a){console.log(a),a&&a.security?($("#es_id").val(a.security.id),$("#es_name").val(a.security.name),$("#es_unitPrice").val(a.security.unit_price)):notify("danger",a.response)},complete:function(){$("#busyDiv").hide()}})}function notify(a,b){demo.initChartist(),$.notify({icon:"pe-7s-gift",message:b},{type:a,timer:3e3})}function deleteSecurity(a){var b=confirm("Really delete security ["+a+"]?");b&&$.ajax({url:endpoint+"delete_security/"+a,type:"GET",dataType:"json",contentType:"application/json",success:function(a){console.log(a);var b="danger";"00"===a.response_code&&(b="info"),$("#securityLink").trigger("click"),notify(b,a.response)},complete:function(){$("#busyDiv").hide()}})}function getRoles(){$("#busyDiv").show(),$.ajax({url:endpoint+"get_roles",type:"GET",dataType:"json",contentType:"application/json",success:function(a){if(console.log(a),a&&a.user_roles){var b=document.getElementById("au_role"),c=document.getElementById("eu_role");populateRole(a.user_roles,b),populateRole(a.user_roles,c)}},complete:function(){$("#busyDiv").fadeOut(500)}})}function getAllStatus(){$("#busyDiv").show(),$.ajax({url:endpoint+"get_all_status",type:"GET",dataType:"json",contentType:"application/json",success:function(a){if(console.log(a),a&&a.all_status){var b=document.getElementById("au_status"),c=document.getElementById("eu_status");populateStatus(a.all_status,b),populateStatus(a.all_status,c)}},complete:function(){$("#busyDiv").fadeOut(500)}})}function populateRole(a,b){if(b){b.options.length=0,b.options[0]=new Option("Select Role","",!1,!1);for(var c=0;c<a.length;c++)b.options[c+1]=new Option(a[c].role_description,a[c].role_id,!1,!1)}}function populateStatus(a,b){if(b){b.options.length=0,b.options[0]=new Option("Select Status","",!1,!1);for(var c=0;c<a.length;c++)b.options[c+1]=new Option(a[c].description,a[c].status_id,!1,!1)}}function editUser(a){showDiv("editUserDiv"),$.ajax({url:endpoint+"get_user/"+a,type:"GET",dataType:"json",contentType:"application/json",success:function(a){console.log(a),a&&a.users?($("#eu_user_id").val(a.users[0].user_id),$("#eu_role").val(a.users[0].role_id),$("#eu_status").val(a.users[0].status_id),$("#eu_username").val(a.users[0].username),$("#eu_name").val(a.users[0].name)):notify("danger",a.response)},complete:function(){$("#busyDiv").hide()}})}function getStatusDesc(a){var b="";return $.ajax({url:endpoint+"get_status/"+a,type:"GET",dataType:"json",contentType:"application/json",async:!1,success:function(a){console.log(a),a&&a.all_status?b=a.all_status[0].description:notify("danger",a.response)}}),console.log(b),b}function getSecurities(){var a=null;return $("#busyDiv").show(),$.ajax({url:endpoint+"get_securities",type:"GET",dataType:"json",contentType:"application/json",async:!1,success:function(b){console.log(b),b&&(a=b)},complete:function(){$("#busyDiv").hide()}}),a}function populateSecurityDrop(a,b){if(b){b.options.length=0,b.options[0]=new Option("Select Security","",!1,!1);for(var c=0;c<a.length;c++)b.options[c+1]=new Option(a[c].name+"  [Unit Price: "+a[c].unit_price+"]",a[c].id,!1,!1)}}function editModel(a){showDiv("editModelDiv");var b=getModel(a);b&&b.models&&($("#em_model_id").val(b.models[0].model_id),$("#em_name").val(b.models[0].name),$("#em_description").val(b.models[0].description));var c=null===b||null===b.response?"":b.response,d=b&&b.response_code&&"00"===b.response_code?"info":"danger";"danger"===d&&notify(d,c)}function getModel(a){var b=null;return $("#busyDiv").show(),$.ajax({url:endpoint+"get_model/"+a,type:"GET",dataType:"json",contentType:"application/json",async:!1,success:function(a){console.log(a),b=a},complete:function(){$("#busyDiv").hide()}}),b}function modifySecurity(a){var b=getModel(a);if(b&&b.models){$("#s2m_model_id").val(b.models[0].model_id),$("#s2m_name").text(b.models[0].name);var c=getSecurities();if(c&&c.securities){var d=document.getElementById("s2m_security");populateSecurityDrop(c.securities,d)}var e=getSecuritiesInModel(a);e&&e.model_detail&&populateTableBody(e.model_detail,"security2ModelTBody"),showDiv("security2ModelDiv")}var f=null===b||null===b.response?"":b.response,g=b&&b.response_code&&"00"===b.response_code?"info":"danger";"danger"===g&&notify(g,f)}function getSecuritiesInModel(a){var b=null;return $("#busyDiv").show(),$.ajax({url:endpoint+"get_securities_in_model/"+a,type:"GET",dataType:"json",contentType:"application/json",async:!1,success:function(a){console.log(a),b=a},complete:function(){$("#busyDiv").hide()}}),b}function removeSecurityFromModel(a,b){$("#busyDiv").show(),$.ajax({url:endpoint+"remove_model_security/"+a,type:"GET",dataType:"json",contentType:"application/json",async:!1,success:function(a){console.log(a),a&&"00"===a.response_code&&modifySecurity(b);var c=null===a||null===a.response?"":a.response,d=a&&a.response_code&&"00"===a.response_code?"info":"danger";"danger"===d&&notify(d,c)},complete:function(){$("#busyDiv").hide()}})}function deleteModel(a){$("#busyDiv").show(),$.ajax({url:endpoint+"delete_model/"+a,type:"GET",dataType:"json",contentType:"application/json",async:!1,success:function(a){console.log(a),a&&a.models&&$("#modelLink").trigger("click");var b=null===a||null===a.response?"":a.response,c=a&&a.response_code&&"00"===a.response_code?"info":"danger";"danger"===c&&notify(c,b)},complete:function(){$("#busyDiv").hide()}})}var endpoint="services/";$(function(){$("#busyDiv").fadeOut(500),$("#securityDiv, #editSecurityDiv, #addUserDiv, #editUserDiv, #modelDiv, #editModelDiv, #security2ModelDiv").hide(),$("ul li a").click(function(){$(this).parent().addClass("active").siblings().removeClass("active")}),$("#es_cancel").click(function(){showDiv("securityDiv")}),$("#eu_cancel").click(function(){showDiv("addUserDiv")}),$("#em_cancel, #s2m_cancel").click(function(){showDiv("modelDiv")}),$("#homeLink, #homeLinkF").click(function(){$("#pageTitle").text("WELCOME"),showDiv("homeDiv")}),$("#securityLink, #securityLinkF").click(function(){$("#pageTitle").text("SECURITIES"),showDiv("securityDiv"),$("#busyDiv").show(),$.ajax({url:endpoint+"get_securities",type:"GET",dataType:"json",contentType:"application/json",success:function(a){a.securities&&populateTableBody(a.securities,"securityTBody")},complete:function(){$("#busyDiv").fadeOut(500)}})}),$("#addSecurityForm").submit(function(a){a.preventDefault(),$("#busyDiv").show(),$.ajax({url:endpoint+"add_security",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify($(this).serializeObject()),success:function(a){console.log(a);var b="danger";if(a.security&&null!==a.security){var b="info";addToTableBody(a.security,"securityTBody"),$("#addSecurityForm")[0].reset()}var c=null===a||null===a.response?"":a.response;notify(b,c)},complete:function(){$("#busyDiv").hide()}})}),$("#editSecurityForm").submit(function(a){a.preventDefault(),$("#busyDiv").show(),$.ajax({url:endpoint+"update_security",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify($(this).serializeObject()),success:function(a){console.log(a);var b="danger";a&&a.security&&(b="info",$("#editSecurityForm")[0].reset(),$("#securityLink").trigger("click"));var c=null===a||null===a.response?"":a.response;notify(b,c)},complete:function(){$("#busyDiv").hide()}})}),$("#wealthMangerLink, #wealthMangerLinkF, #clientLink, #clientLinkF").click(function(a){var b="CLIENTS",c="Client List",d="Client";$("#au_source, #eu_source").val("Client");var e=$(this).attr("id");"wealthMangerLink"!==e&&"wealthMangerLinkF"!==e||(d="WealthManager",b="WEALTH MANAGERS",c="Wealth Manager List",$("#au_source, #eu_source").val("WealthManager")),$("#pageTitle").text(b),$("#userListTitle").text(c),getRoles(),getAllStatus(),showDiv("addUserDiv"),$("#busyDiv").show(),$.ajax({url:endpoint+"get_specific_users/"+d,type:"GET",dataType:"json",contentType:"application/json",success:function(a){console.log(a),a&&populateTableBody(a.users,"userTBody")},complete:function(){$("#busyDiv").fadeOut(500)}})}),$("#addUserForm").submit(function(a){a.preventDefault(),$("#busyDiv").show();var b=$(this).serializeObject();$.ajax({url:endpoint+"add_user",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(b),success:function(a){console.log(a);var c="danger";if(a&&a.users){var c="info";"Client"===b.au_source?$("#clientLink").trigger("click"):$("#wealthMangerLink").trigger("click"),$("#addUserForm")[0].reset()}var d=null===a||null===a.response?"":a.response;notify(c,d)},complete:function(){$("#busyDiv").hide()}})}),$("#editUserForm").submit(function(a){a.preventDefault();var b=$(this).serializeObject();$("#busyDiv").show(),$.ajax({url:endpoint+"update_user",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(b),success:function(a){console.log(a);var c="danger";a&&a.users&&(c="info",$("#editUserForm")[0].reset(),"Client"===b.eu_source?$("#clientLink").trigger("click"):$("#wealthMangerLink").trigger("click"));var d=null===a||null===a.response?"":a.response;notify(c,d)},complete:function(){$("#busyDiv").hide()}})}),$("#modelLink, #modelLinkF").click(function(){$("#pageTitle").text("MODELS"),showDiv("modelDiv"),$("#busyDiv").show(),$.ajax({url:endpoint+"get_models",type:"GET",dataType:"json",contentType:"application/json",success:function(a){console.log(a),a.models&&populateTableBody(a.models,"modelTBody");var b=null===a||null===a.response?"":a.response,c=a&&a.response_code&&"00"===a.response_code?"info":"danger";notify(c,b)},complete:function(){$("#busyDiv").fadeOut(500)}})}),$("#addModelForm").submit(function(a){a.preventDefault(),$("#busyDiv").show(),$.ajax({url:endpoint+"add_model",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify($(this).serializeObject()),success:function(a){console.log(a),a&&a.models&&(addToTableBody(a.models[0],"modelTBody"),$("#addModelForm")[0].reset());var b=null===a||null===a.response?"":a.response,c=a&&a.response_code&&"00"===a.response_code?"info":"danger";notify(c,b)},complete:function(){$("#busyDiv").hide()}})}),$("#editModelForm").submit(function(a){a.preventDefault(),$("#busyDiv").show(),$.ajax({url:endpoint+"update_model",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify($(this).serializeObject()),success:function(a){console.log(a);var b="danger";a&&a.models&&(b="info",$("#editModelForm")[0].reset(),$("#modelLink").trigger("click"));var c=null===a||null===a.response?"":a.response;notify(b,c)},complete:function(){$("#busyDiv").hide()}})}),$("#security2ModelForm").submit(function(a){a.preventDefault(),$("#busyDiv").show(),$.ajax({url:endpoint+"add_security_to_model",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify($(this).serializeObject()),success:function(a){console.log(a),a&&a.model_detail&&(addToTableBody(a.model_detail,"security2ModelTBody"),$("#security2ModelForm")[0].reset());var b=null===a||null===a.response?"":a.response,c=a&&a.response_code&&"00"===a.response_code?"info":"danger";notify(c,b)},complete:function(){$("#busyDiv").hide()}})})}),$.fn.serializeObject=function(){var a={},b=this.serializeArray();return $.each(b,function(){void 0!==a[this.name]?(a[this.name].push||(a[this.name]=[a[this.name]]),a[this.name].push(this.value||"")):a[this.name]=this.value||""}),a};